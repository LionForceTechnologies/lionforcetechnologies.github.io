{"version":3,"sources":["routes/editor/index.js"],"names":["Editor","useState","start","setstart","check","setcheck","setspin","dispatch","useDispatch","set_editor","useSelector","crud","seteditor","geta_page","getpage","spinner","query","URLSearchParams","useLocation","search","console","log","get","length","localStorage","removeItem","useEffect","setItem","mvna_assets","mvna_components","mvna_css","mvna_html","mvna_styles","e","GrapesJS","init","container","fromElement","plugins","grapesjsLorySlider","grapesjsPresetWebpage","grapesjsPluginExport","grapesjsBlocksFlexbox","panels","commands","panelManager","runCommand","Panels","panel","Commands","sm","StorageManager","addPanel","id","visible","buttons","className","attributes","title","command","add","run","editor","sender","load","res","getHtml","getCss","JSON","stringify","putpage","gjs_styles","getItem","gjs_css","gjs_components","gjs_html","gjs_assets","webHTML","webCss","havedata","document","getElementById","style","height"],"mappings":"2TAiJeA,UA7Hf,WAAkB,MAGUC,mBAAS,GAHnB,mBAGTC,EAHS,KAGFC,EAHE,OAIUF,mBAAS,GAJnB,mBAITG,EAJS,KAIFC,EAJE,OAKQJ,mBAAS,IALjB,mBAKHK,GALG,WAMVC,EAAWC,cAEXC,EAAaC,aAAY,qBAAGC,KAAgBC,aAC5CC,EAAYH,aAAY,qBAAGC,KAAgBG,WAC3CC,EAAUL,aAAY,qBAAGC,KAAgBI,WAI3CC,EAFK,IAAIC,gBAAgBC,cAAcC,QAyG3C,OAtGAC,QAAQC,IAAI,iBACZD,QAAQC,IAAIL,EAAMM,IAAI,OAEnBT,EAAUU,OAAS,GACR,GAATnB,IACDoB,aAAaC,WAAW,cACxBD,aAAaC,WAAW,kBACxBD,aAAaC,WAAW,WACxBD,aAAaC,WAAW,YACxBD,aAAaC,WAAW,cACxBpB,EAAS,IAGbqB,qBAAU,WAIM,GAAXX,GACDT,EAAQ,OAGZoB,qBAAU,WACI,GAATxB,IACDK,EAASO,YAAQE,EAAMM,IAAI,QAC3BnB,EAAS,OAObuB,qBAAU,WACLb,EAAUU,OAAS,GACpBC,aAAaG,QAAQ,aAAad,EAAU,GAAGe,aAC/CJ,aAAaG,QAAQ,iBAAiBd,EAAU,GAAGgB,iBACnDL,aAAaG,QAAQ,UAAUd,EAAU,GAAGiB,UAC5CN,aAAaG,QAAQ,WAAWd,EAAU,GAAGkB,WAC7CP,aAAaG,QAAQ,aAAad,EAAU,GAAGmB,eAG/CR,aAAaC,WAAW,cACxBD,aAAaC,WAAW,kBACxBD,aAAaC,WAAW,WACxBD,aAAaC,WAAW,YACxBD,aAAaC,WAAW,eAE1B,IAAMQ,EAAIC,IAASC,KAAK,CACtBC,UAAU,kBACVC,aAAa,EACbC,QAAS,CAACC,IAAmBC,IAAsBC,IAAqBC,KACxEC,OAAQ,GAGRC,SAAU,KAQNC,GADOZ,EAAEa,WAAW,iBACLb,EAAEc,QACjBC,EAAQf,EAAEgB,SACVC,EAAKjB,EAAEkB,eACEN,EAAaO,SAAS,CACnCC,GAAI,aACJC,SAAS,EACTC,QAAS,CAAC,CACRF,GAAI,QACJG,UAAW,aACXC,WAAY,CAAEC,MAAO,gBACrBC,QAAS,oBAGbX,EAAMY,IAAI,gBAAiB,CACzBC,IAAK,SAAUC,EAAQC,GACrBb,EAAGc,KAAK,CAAC,MAAO,SAAS,SAAUC,GAGzBhC,EAAEiC,UACHjC,EAAEkC,SAGT3C,aAAaG,QAAQ,WAAYyC,KAAKC,UAAUJ,IAChD1D,EAAS+D,YAAQ,CACfC,WAAa/C,aAAagD,QAAQ,cAClCC,QAAUjD,aAAagD,QAAQ,WAC/BE,eAAiBlD,aAAagD,QAAQ,kBACtCG,SAAWnD,aAAagD,QAAQ,YAChCI,WAAapD,aAAagD,QAAQ,cAClCnB,GAAKrC,EAAMM,IAAI,MACfuD,QAAU5C,EAAEiC,UACZY,OAAS7C,EAAEkC,SACXY,SAAWtE,cAMrBiB,qBAAU,WACRsD,SAASC,eAAe,kBAAkBC,MAAMC,OAAS,UAGzD,oCACY,SAAXpE,EAAsB,kBAAC,IAAD,KAAO,yBAAKsC,GAAG,oBAAmC,yBAAKA,GAAG","file":"static/js/6.f83fea7e.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport 'grapesjs/dist/css/grapes.min.css';\r\n// import \"./ui_style.css\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {  getdata, seteditor,putpage,getpage,setspinner} from \"../../appRedux/actions/Crud\";\r\n// import { useDispatch, useSelector } from \"react-redux\";\r\nimport { userSignIn } from \"../../appRedux/actions/Auth\";\r\n\r\nimport GrapesJS from 'grapesjs';\r\nimport gjsBasicBlocks from 'grapesjs-blocks-basic';\r\nimport gjsNavbar from 'grapesjs-navbar';\r\nimport grapesjsCustomCode from 'grapesjs-custom-code';\r\nimport grapesjsLorySlider from 'grapesjs-lory-slider'\r\n\r\nimport grapesjsPluginExport from 'grapesjs-plugin-export';\r\nimport grapesjsPresetWebpage from 'grapesjs-preset-webpage';\r\nimport grapesjsBlocksFlexbox from 'grapesjs-blocks-flexbox';\r\nimport { Link, useLocation, BrowserRouter as Router } from \"react-router-dom\";\r\nimport { Spin } from \"antd\";\r\nimport axios from 'util/Api'\r\nfunction Editor() {\r\n  // const [htmlString, setHtmlString] = useState(null);\r\n  // const [cssString, setCssString] = useState(\"\");\r\n  const [start, setstart] = useState(0);\r\n  const [check, setcheck] = useState(0);\r\n  const [spin, setspin] = useState('');\r\n  const dispatch = useDispatch();\r\n  // const red_data = useSelector(({ crud }) => crud.seteditor);\r\n  const set_editor = useSelector(({ crud }) => crud.seteditor);\r\n  const geta_page = useSelector(({ crud }) => crud.getpage);\r\n  const spinner = useSelector(({ crud }) => crud.spinner);\r\n  function useQuery() {\r\n    return new URLSearchParams(useLocation().search);\r\n  }\r\n  let query = useQuery();\r\n  console.log('testing query');\r\n  console.log(query.get(\"id\"));\r\n\r\n  if(geta_page.length > 0){\r\n    if(check == 0){\r\n      localStorage.removeItem('gjs-assets')\r\n      localStorage.removeItem('gjs-components')\r\n      localStorage.removeItem('gjs-css')\r\n      localStorage.removeItem('gjs-html')\r\n      localStorage.removeItem('gjs-styles')\r\n      setcheck(1)\r\n    }\r\n  }\r\n  useEffect(() =>{\r\n    if(spinner == 1){\r\n      \r\n    }\r\n    if(spinner == 0){\r\n      setspin('')\r\n    }\r\n  })\r\n  useEffect(() =>{\r\n    if(start == 0){\r\n      dispatch(getpage(query.get(\"id\")))\r\n      setstart(1)\r\n    } \r\n  })\r\n  // useEffect(()=> {\r\n    \r\n  // })\r\n\r\n  useEffect(() => {\r\n    if(geta_page.length > 0){\r\n      localStorage.setItem('gjs-assets',geta_page[0].mvna_assets)\r\n      localStorage.setItem('gjs-components',geta_page[0].mvna_components)\r\n      localStorage.setItem('gjs-css',geta_page[0].mvna_css)\r\n      localStorage.setItem('gjs-html',geta_page[0].mvna_html)\r\n      localStorage.setItem('gjs-styles',geta_page[0].mvna_styles)\r\n    }\r\n    else{\r\n      localStorage.removeItem('gjs-assets')\r\n      localStorage.removeItem('gjs-components')\r\n      localStorage.removeItem('gjs-css')\r\n      localStorage.removeItem('gjs-html')\r\n      localStorage.removeItem('gjs-styles')\r\n    }\r\n    const e = GrapesJS.init({\r\n      container: `#example-editor`,\r\n      fromElement: true,\r\n      plugins: [grapesjsLorySlider,grapesjsPresetWebpage,grapesjsPluginExport,grapesjsBlocksFlexbox],\r\n      panels: {\r\n\r\n      },\r\n      commands: {\r\n\r\n      },\r\n      // canvas: {\r\n      //   core:'canvas-clear'\r\n      // }\r\n    });\r\n    let dashed = e.runCommand('sw-visibility');    \r\n    const panelManager = e.Panels;\r\n    const panel = e.Commands;\r\n    const sm = e.StorageManager\r\n    let newPanel = panelManager.addPanel({\r\n      id: 'myNewPanel',\r\n      visible: true,\r\n      buttons: [{\r\n        id: 'smile',\r\n        className: 'fa fa-save',\r\n        attributes: { title: 'Update Promo' },\r\n        command: 'customCommand'\r\n      }],\r\n    });\r\n    panel.add('customCommand', {\r\n      run: function (editor, sender) {\r\n        sm.load(['css', 'html'], function (res) {\r\n          // console.log(res)\r\n          let jar = {\r\n            html: e.getHtml(),\r\n            css: e.getCss()\r\n          }\r\n\r\n          localStorage.setItem('renderer', JSON.stringify(res));\r\n          dispatch(putpage({\r\n            gjs_styles : localStorage.getItem('gjs-styles'),\r\n            gjs_css : localStorage.getItem('gjs-css'),\r\n            gjs_components : localStorage.getItem('gjs-components'),\r\n            gjs_html : localStorage.getItem('gjs-html'),\r\n            gjs_assets : localStorage.getItem('gjs-assets'),\r\n            id : query.get(\"id\"),\r\n            webHTML : e.getHtml(),\r\n            webCss : e.getCss(),\r\n            havedata : set_editor\r\n          }))\r\n        })\r\n      }\r\n    });\r\n  });\r\n  useEffect(()=> {\r\n    document.getElementById('example-editor').style.height = '100%'\r\n  })\r\n  return (\r\n    <>\r\n    {spinner == 'start' ? (<Spin ><div id=\"example-editor\" ></div></Spin>) :(<div id=\"example-editor\" ></div>)}\r\n    \r\n\r\n    </>\r\n  );\r\n}\r\nexport default Editor"],"sourceRoot":""}